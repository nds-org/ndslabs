<section id="navbar">
  <!-- Fixed navbar -->
  <div sticky class="navbar navbar-default navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <div class="navbar-brand cursor-pointer">
          <!-- Draw the brand logo -->
          <a href="{{ home.url }}" class="undecorate-link">
            <img id="navBrandLogo" src="asset/png/favicon-32x32.png" alt="{{ home.name }}" height="32" width="32"> {{ home.name }} <sup><small><small>BETA</small></small></sup>
          </a>
        </div>
      </div>
      
      <div ng-controller="LoginController" ng-show="!settings.token">
        <div class="navbar-collapse collapse" ng-controller="NavbarController">
          <ul class="nav navbar-nav navbar-right">
            <!-- First, draw our help links -->
            <li>
    	        <a class="dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-fw fa-question-circle-o"></i> <span class="caret"></span>
              </a>
              
              <ul class="dropdown-menu dropdown-menu-right" ng-class="{ 'open': settings.isOpen }" role="menu">
                <li ng-repeat="link in helpLinks"><a ng-href="{{ link.url }}" target="_blank"><i class="fa fa-fw {{ link.icon }}"></i> {{ link.name }}</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="#/contact"><i class="fa fa-fw fa-support"></i> Contact Us</a></li>
              </ul>
            </li>
            <!-- Then draw our register / login links -->
            <li><a href="#/register">Register</a></li>
            <li><a href="#/login">Login</a></li>
          </ul>
        </div>
      </div>
      
      <div ng-controller="LoginController" ng-show="settings.token">
        <div class="navbar-collapse collapse" ng-controller="NavbarController">
          <!-- Draw once for the left half of the navbar, and once again for the right -->
          <ul class="nav navbar-nav {{ navFilter === 'right' ? 'navbar-right' : '' }}" ng-repeat="navFilter in ::['left', 'right']">
            <li ng-repeat="nav in navs | navbar:navFilter" ng-class="{ 'active':nav.url.indexOf(path) !== -1, 'dropdown':isArray(nav.url) }">
              <!-- Display names given without URL as text -->
              <span ng-if="!nav.url"><i ng-if="nav.icon" class="fa fa-fw {{ nav.icon }}"></i> {{ nav.name }}</span>
              
              <!-- Navbar Link for a singular string URL -->
              <a ng-if="nav.url && !isArray(nav.url)" ng-href="{{ nav.url }}"><i ng-if="nav.icon" class="fa fa-fw {{ nav.icon }}"></i> {{ nav.name }}</a>
              
              <!-- Dropdown Menu for a URL array -->
              <a ng-if="isArray(nav.url)" ng-mouseenter="nav.isOpen=!nav.isOpen" ng-mouseleave="nav.isOpen=!nav.isOpen" class="dropdown-toggle" data-toggle="dropdown">{{ nav.name }} <span class="caret"></span></a>
              <ul ng-if="isArray(nav.url)" class="dropdown-menu" ng-class="{ 'open': nav.isOpen, 'dropdown-menu-right':nav.right  }" role="menu">
                <li ng-repeat="innerNav in nav.url" ng-class="{ 'active':path.url.indexOf(innerNav) !== -1 }" >
                  <a ng-href="{{ innerNav.url }}"><i ng-if="nav.icon" class="fa fa-fw {{ nav.icon }}"></i> {{ innerNav.name }}</a>
                </li>
              </ul>
            </li>
            
  	        <!-- Then draw our Manage Files button -->
            <li ng-if="navFilter === 'left'" ng-controller="DashboardController">
              <a type="button" ng-click="launchFileManager()">
                 <i class="fa fa-fw" ng-class="{ 'fa-spinner fa-spin': launchingFileManager, 'fa-files-o': !launchingFileManager }"></i> Files
              </a>
            </li>
            
            <!-- Next, draw our help links -->
            <li ng-if="navFilter === 'right'">
    	        <a class="dropdown-toggle" data-toggle="dropdown">
    	          <i class="fa fa-fw fa-question-circle-o"></i> <span class="caret"></span>
              </a>
    	        
              <ul class="dropdown-menu dropdown-menu-right" ng-class="{ 'open': settings.isOpen }" role="menu">
                <li ng-repeat="link in helpLinks"><a ng-href="{{ link.url }}" target="_blank"><i class="fa fa-fw {{ link.icon }}"></i> {{ link.name }}</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="#/contact"><i class="fa fa-fw fa-support"></i> Contact Us</a></li>
              </ul>
            </li>
            
  	        <!-- Finally, draw our account settings button -->
            <li ng-if="navFilter === 'right'">
    	        <a class="dropdown-toggle" data-toggle="dropdown">
    	          <img ng-show="loadingSmall.promise.$$state.status === 1" gravatar-src="settings.project.email" gravatar-size="20" style="border-radius:50px;margin-right:10px;" />
    	          {{ settings.namespace }} <span class="caret"></span>
  	          </a>
  	          
              <ul class="dropdown-menu dropdown-menu-right" ng-class="{ 'open': settings.isOpen }" role="menu">
                <li><a ng-href="#/recover?t={{ settings.token }}"><i class="fa fa-fw fa-unlock-alt"></i> Change Password</a></li>
                <li><a id="dropDownButton" type="button" ng-click="logout()"><i class="fa fa-fw fa-sign-out"></i> Logout</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
  </div>
</section>
